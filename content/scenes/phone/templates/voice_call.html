<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Call</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/voice_call.css') }}">
</head>
<body>
    <!-- Incoming Call Screen -->
    <div class="call-screen incoming-call" id="incomingCallScreen" style="display:none;">
        <div class="caller-info">
            <div class="caller-avatar" id="incomingAvatar">
                <img src="/static/img/default-avatar.png" alt="Avatar">
            </div>
            <h2 class="caller-name" id="incomingCallerName">Unknown</h2>
            <p class="call-status">Incoming call...</p>
        </div>
        
        <div class="call-actions">
            <button class="call-action-btn decline" onclick="declineCall()">
                <span class="icon">ðŸ“µ</span>
                <span class="label">Decline</span>
            </button>
            <button class="call-action-btn answer" onclick="answerCall()">
                <span class="icon">ðŸ“ž</span>
                <span class="label">Answer</span>
            </button>
        </div>
        
        <!-- Ringtone -->
        <audio id="ringtone" loop>
            <source src="{{ url_for('static', filename='audio/ringtone.mp3') }}" type="audio/mpeg">
        </audio>
    </div>
    
    <!-- Active Call Screen -->
    <div class="call-screen active-call" id="activeCallScreen" style="display:none;">
        <div class="call-header">
            <div class="caller-avatar-small" id="activeAvatar">
                <img src="/static/img/default-avatar.png" alt="Avatar">
            </div>
            <div class="call-info">
                <h3 class="caller-name" id="activeCallerName">Unknown</h3>
                <p class="call-status">Connected</p>
            </div>
        </div>
        
        <div class="call-duration-container">
            <div class="call-timer" id="callTimer">00:00</div>
            <div class="audio-visualizer" id="audioVisualizer">
                <div class="visualizer-bar"></div>
                <div class="visualizer-bar"></div>
                <div class="visualizer-bar"></div>
                <div class="visualizer-bar"></div>
                <div class="visualizer-bar"></div>
            </div>
        </div>
        
        <div class="call-controls">
            <button class="call-control-btn" id="muteBtn" onclick="toggleMute()">
                <span class="icon">ðŸ”‡</span>
                <span class="label">Mute</span>
            </button>
            <button class="call-control-btn" id="speakerBtn" onclick="toggleSpeaker()">
                <span class="icon">ðŸ”Š</span>
                <span class="label">Speaker</span>
            </button>
            <button class="call-control-btn end" onclick="endCall()">
                <span class="icon">ðŸ“µ</span>
                <span class="label">End Call</span>
            </button>
        </div>
        
        <!-- Audio elements for call -->
        <audio id="callAudio" autoplay></audio>
        <audio id="dialTone">
            <source src="{{ url_for('static', filename='audio/dial_tone.mp3') }}" type="audio/mpeg">
        </audio>
    </div>
    
    <!-- Call Ended Screen -->
    <div class="call-screen call-ended" id="callEndedScreen" style="display:none;">
        <div class="call-ended-info">
            <div class="ended-icon">ðŸ“ž</div>
            <h2>Call Ended</h2>
            <div class="call-stats">
                <p class="caller-name" id="endedCallerName">Unknown</p>
                <p class="call-duration">Duration: <span id="finalDuration">00:00</span></p>
            </div>
        </div>
        
        <div class="call-ended-actions">
            <button class="call-again-btn" onclick="callAgain()">
                <span class="icon">ðŸ“ž</span>
                <span class="label">Call Again</span>
            </button>
            <button class="close-btn" onclick="closeCallScreen()">
                <span class="label">Close</span>
            </button>
        </div>
    </div>
    
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="{{ url_for('static', filename='js/voice.js') }}"></script>
</body>
</html>
